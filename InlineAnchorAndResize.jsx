//InlineAnchorAndResize.jsx// User selects a textFrame and an object to inline anchor in to the text.// The script inline anchors the object either to the left or right of the text (depending on its position).// It then resizes the textFrame to allow for the object.////TODO: remove object style?//TODO: maybe have a script where you select multiple objects and it searches for other groupings of the same type and relative positions. Then select a script to run on them.app.doScript( main, undefined, undefined, UndoModes.FAST_ENTIRE_SCRIPT );function main() {    var sel = app.selection;	if ( sel.length == 2 ) {		var text = false;		var graphic = false;		if ( sel[0] instanceof TextFrame && !(sel[1] instanceof TextFrame) ) {			text = sel[0];			graphic = sel[1];		}		else if ( sel[1] instanceof TextFrame && !(sel[0] instanceof TextFrame) ) {			text = sel[1];			graphic = sel[0];		}		if ( text != false && graphic != false ) {			para = text.paragraphs[0];			if ( graphic.geometricBounds[3] > text.geometricBounds[3] ) var insertAt = para.insertionPoints[para.insertionPoints.length-2]; //insert to the right			else var insertAt = para.insertionPoints[0]; //insert to the left			var graphicHeight = graphic.geometricBounds[2] - graphic.geometricBounds[0];			var graphicWidth = graphic.geometricBounds[3] - graphic.geometricBounds[1];			var textHeight = text.geometricBounds[2] - text.geometricBounds[0];              var lineHeight = ( textHeight / text.lines.length ) + 0.05;             			if ( graphicHeight > textHeight ) {				textBounds = text.geometricBounds;				textBounds[0] = textBounds[2] - ( ( text.lines.length - 1) * lineHeight ) - graphicHeight;                  textBounds[1] = textBounds[1] - graphicWidth;				text.geometricBounds = textBounds; //resize				text.move(null,[0,0]); //I think this fixes the position. It seemed to anyway.			}								graphic.anchoredObjectSettings.insertAnchoredObject( insertAt, AnchorPosition.INLINE_POSITION );                          //var iconStyle = app.documents[0].objectStyles.itemByName('$ID/web-icons');              //if ( iconStyle.isValid ) graphic.appliedObjectStyle = iconStyle;              			return true; //done		}		}    alert( "You must select 2 items: a textFrame and an Image/Group/Graphic to inline-anchor in to the text" );}